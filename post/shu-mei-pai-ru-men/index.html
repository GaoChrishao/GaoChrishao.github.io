<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>æ ‘è“æ´¾å…¥é—¨ | GCH&#39;s blog</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://gaochrishao.github.io/favicon.ico?v=1626083763859">
<link rel="stylesheet" href="https://gaochrishao.github.io/styles/main.css">



<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="ğŸ’»ï¼šæ ‘è“æ´¾4B 2Gå†…å­˜
ğŸ“¦ï¼š1.è®¾å¤‡å®‰è£…ã€2.åŸºæœ¬é…ç½®ã€3.æ¸©æ§é£æ‰‡ã€4.æ‘„åƒå¤´é…ç½®
1.å®‰è£…
1.1 å‡†å¤‡å·¥ä½œ

sdå¡ï¼Œ&gt;=16GB
hdmiçº¿
æ˜¾ç¤ºå™¨
é¼ æ ‡é”®ç›˜

1.2çƒ§å…¥ç³»ç»Ÿ

ä¸‹è½½å®˜æ–¹NOOBS
æ ¼å¼åŒ–sdå¡ä¸ºfat..." />
    <meta name="keywords" content="Linux" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://gaochrishao.github.io">
        <img src="https://gaochrishao.github.io/images/avatar.png?v=1626083763859" class="site-logo">
        <h1 class="site-title">GCH&#39;s blog</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            å…³äº
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/GaoChrishao" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
      
        
      
        
      
        
      
    </div>
    <div class="site-description">
      GCH's blog
    </div>
    <div class="site-footer">
      å¤‡æ¡ˆå·ï¼šçš–ICPå¤‡19004020å· | <a class="rss" href="https://gaochrishao.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">æ ‘è“æ´¾å…¥é—¨</h2>
            <div class="post-date">2021-07-12</div>
            
              <div class="feature-container" style="background-image: url('https://gaochrishao.github.io/post-images/shu-mei-pai-ru-men.jfif')">
              </div>
            
            <div class="post-content" v-pre>
              <p>ğŸ’»ï¼šæ ‘è“æ´¾4B 2Gå†…å­˜<br>
ğŸ“¦ï¼š1.è®¾å¤‡å®‰è£…ã€2.åŸºæœ¬é…ç½®ã€3.æ¸©æ§é£æ‰‡ã€4.æ‘„åƒå¤´é…ç½®</p>
<h2 id="1å®‰è£…">1.å®‰è£…</h2>
<h3 id="11-å‡†å¤‡å·¥ä½œ">1.1 å‡†å¤‡å·¥ä½œ</h3>
<blockquote>
<p>sdå¡ï¼Œ&gt;=16GB</p>
<p>hdmiçº¿</p>
<p>æ˜¾ç¤ºå™¨</p>
<p>é¼ æ ‡é”®ç›˜</p>
</blockquote>
<h3 id="12çƒ§å…¥ç³»ç»Ÿ">1.2çƒ§å…¥ç³»ç»Ÿ</h3>
<blockquote>
<p>ä¸‹è½½å®˜æ–¹NOOBS</p>
<p>æ ¼å¼åŒ–sdå¡ä¸ºfat32æ ¼å¼</p>
<p>è§£å‹NOOBSå‹ç¼©åŒ…åˆ°sdå¡</p>
<p>æ ‘è“æ´¾æ’å¡ï¼Œæ¥ç”µï¼Œè¿æ¥æ˜¾ç¤ºå™¨é¼ æ ‡é”®ç›˜</p>
</blockquote>
<h3 id="13å®‰è£…ç³»ç»Ÿ">1.3å®‰è£…ç³»ç»Ÿ</h3>
<blockquote>
<p>æ¥ç”µåæ ‘è“æ´¾è‡ªåŠ¨å¯åŠ¨</p>
<p>é€‰æ‹©è¦å®‰è£…çš„ç³»ç»Ÿè¿›è¡Œå®‰è£…ï¼Œç­‰å¾…10min</p>
<p>é‡å¯åè¿›å…¥ç³»ç»Ÿ</p>
</blockquote>
<h2 id="2åŸºæœ¬é…ç½®">2.åŸºæœ¬é…ç½®</h2>
<h3 id="21-ä¿®æ”¹å¯†ç ">2.1 ä¿®æ”¹å¯†ç </h3>
<blockquote>
<p>ç¬¬ä¸€æ¬¡è¿›å…¥ç³»ç»Ÿä¼šè¦æ±‚è®¾ç½®piè´¦å·çš„å¯†ç </p>
<p>sudo suè¿›å…¥rootï¼Œ ä½¿ç”¨passwd rootæ¥ä¿®æ”¹rootè´¦å·çš„å¯†ç </p>
</blockquote>
<h3 id="22-å¼€å¯sshå’Œvnc">2.2 å¼€å¯sshå’Œvnc</h3>
<blockquote>
<p>å‘½ä»¤è¡Œè¾“å…¥ï¼šraspi-config</p>
<p>é€‰æ‹©ï¼š5 Interfacing Options</p>
<p>é€‰æ‹©SSHå’ŒVNCæ¥å¼€å¯</p>
</blockquote>
<h3 id="23æ¢æº">2.3æ¢æº</h3>
<blockquote>
<p>1.å¤‡ä»½æºæ–‡ä»¶</p>
<pre><code class="language-sh">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak
sudo cp /etc/apt/sources.list.d/raspi.list  /etc/apt/sources.list.d/raspi.list.bak
</code></pre>
<p>2.ä¿®æ”¹è½¯ä»¶æ›´æ–°æº</p>
<pre><code class="language-sh">sudo nano /etc/apt/sources.list
</code></pre>
<p>3.å°†ç¬¬ä¸€è¡Œä¿®æ”¹æˆä¸­ç§‘å¤§çš„è½¯ä»¶æºåœ°å€ï¼Œã€ŒCtrl+Oã€è¿›è¡Œä¿å­˜ï¼Œç„¶åå›è½¦ï¼Œã€ŒCtrl+Xã€é€€å‡ºã€‚</p>
<pre><code class="language-sh">deb http://mirrors.ustc.edu.cn/raspbian/raspbian/ stretch main contrib non-free rpi
</code></pre>
<p>4.ä¿®æ”¹ç³»ç»Ÿæ›´æ–°æº</p>
<pre><code class="language-sh">sudo nano /etc/apt/sources.list.d/raspi.list
</code></pre>
<p>5.å°†ç¬¬ä¸€è¡Œä¿®æ”¹æˆä¸­ç§‘å¤§çš„ç³»ç»Ÿæºåœ°å€ï¼Œã€ŒCtrl+Oã€è¿›è¡Œä¿å­˜ï¼Œç„¶åå›è½¦ï¼Œã€ŒCtrl+Xã€é€€å‡ºã€‚</p>
<pre><code class="language-sh">deb http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/ stretch main ui
</code></pre>
<p>6.åŒæ­¥æ›´æ–°æº</p>
<pre><code class="language-sh">sudo apt-get update
</code></pre>
<p>7.æ›´æ–°å‡çº§ä»¥å®‰è£…è½¯ä»¶åŒ…ï¼Œè¿™ä¸ªè¿‡ç¨‹è€—æ—¶è¾ƒé•¿ã€‚</p>
<pre><code class="language-sh">sudo apt-get upgrade
</code></pre>
<p>è½¬è½½è¿æ¥:<a href="https://www.jianshu.com/p/768f0181672b">https://www.jianshu.com/p/768f0181672b</a></p>
</blockquote>
<h3 id="24ufwé˜²ç«å¢™è®¾ç½®">2.4UFWé˜²ç«å¢™è®¾ç½®</h3>
<blockquote>
<p>1.å®‰è£…</p>
<pre><code class="language-sh">sudo apt-get install ufw
</code></pre>
<p>2.å¯ç”¨</p>
<pre><code class="language-sh">sudo ufw enable
sudo ufw default deny
</code></pre>
<p>3.å…³é—­</p>
<pre><code class="language-sh">sudo ufw disable
</code></pre>
<p>4.æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</p>
<pre><code class="language-sh">sudo ufw status
</code></pre>
<p>5.å¼€å¯/ç¦ç”¨ç«¯å£æˆ–æœåŠ¡ä¸¾ä¾‹</p>
<pre><code class="language-sh">sudo ufw allow 80 å…è®¸å¤–éƒ¨è®¿é—®80ç«¯å£
sudo ufw delete allow 80 ç¦æ­¢å¤–éƒ¨è®¿é—®80 ç«¯å£
sudo ufw allow from 192.168.1.1 å…è®¸æ­¤IPè®¿é—®æ‰€æœ‰çš„æœ¬æœºç«¯å£
sudo ufw deny smtp ç¦æ­¢å¤–éƒ¨è®¿é—®smtpæœåŠ¡
sudo ufw delete allow smtp åˆ é™¤ä¸Šé¢å»ºç«‹çš„æŸæ¡è§„åˆ™
sudo ufw deny proto tcp from 10.0.0.0/8 to 192.168.0.1 port è¦æ‹’ç»æ‰€æœ‰çš„æµé‡ä»TCPçš„10.0.0.0/8 åˆ°ç«¯å£22çš„åœ°å€192.168.0.1
</code></pre>
<p>6.å¼€å¯ç«¯å£è®¿é—®</p>
<pre><code class="language-sh">sudo ufw allow 22
sudo ufw allow 3306
</code></pre>
</blockquote>
<h3 id="25è“ç‰™è¿æ¥">2.5è“ç‰™è¿æ¥</h3>
<pre><code class="language-sh">#1.æ‰“å¼€è“ç‰™
sudo service bluetooth start
#2.è¿›å…¥bluetoothctl
bluetoothctl
#3.è¾“å…¥ä»¥ä¸‹å‘½ä»¤
power on 
agent on 
default-agent 
scan on 
pair yourDeviceMAC
connect yourDeviceMAC
</code></pre>
<h2 id="3æ¸©æ§é£æ‰‡">3æ¸©æ§é£æ‰‡</h2>
<h3 id="31ç”µè·¯è¿æ¥">3.1ç”µè·¯è¿æ¥</h3>
<p>ä½¿ç”¨è®¾å¤‡ï¼šä¸‰æç®¡s8050	5vç”µé£æ‰‡</p>
<p>è¿çº¿æ–¹å¼</p>
<blockquote>
<p>Cææ¥5Væ­£æï¼Œ2å·æˆ–4å·å¼•è„š<br>
Eææ¥åœ°ï¼Œ6å·å¼•è„š<br>
Bææ¥GPIOå¼•è„šå£ï¼Œè‡ªå·±å®š<br>
å…·ä½“å¼•è„šä½ç½®è§è¿™<a href="https://github.com/Yradex/RaspberryPi3_OS/wiki/%E6%A0%91%E8%8E%93%E6%B4%BE-3-UART-%E5%8F%8A-GPIO-%E9%92%88%E8%84%9A%E5%AE%9A%E4%B9%89">æ ‘è“æ´¾å¼•è„š</a></p>
</blockquote>
<p>æœ€ç»ˆè¿çº¿æ–¹å¼<br>
<img src="https://gaochrishao.github.io/post-images/1626082389805.png" alt="" loading="lazy"></p>
<h3 id="32æ§åˆ¶ä»£ç ">3.2æ§åˆ¶ä»£ç </h3>
<pre><code class="language-python">#!/usr/bin/python2.7
#coding:utf-8
from RPi import GPIO as gpio #æ³¨æ„RPiä¸­çš„iæ˜¯å°å†™çš„
import time
#è·å–cpuçš„æ¸©åº¦
def get_cpu_temp():
    with open(&quot;/sys/class/thermal/thermal_zone0/temp&quot;, 'r') as f:
        temp = float(f.read()) / 1000
    return temp
 
#ç›‘æ§æ¸©åº¦ï¼Œæ§åˆ¶é£æ‰‡å¼€å…³
def check_temp(port):
    #BOARDç¼–å·æ–¹å¼ï¼ŒåŸºäºæ’åº§å¼•è„šç¼–å·
    gpio.setmode(gpio.BOARD)
    #è®¾ç½®å“ªä¸ªå¼•è„šä¸ºè¾“å‡ºæ¨¡å¼
    gpio.setup(port, gpio.OUT)
    #æ ‡è®°é£æ‰‡å¼€å…³çŠ¶æ€
    is_close = True
    try:
        while True:
            temp = get_cpu_temp()
            if is_close:
            #æ¸©åº¦å¤§äºç­‰äº47æ—¶ï¼Œæ‰“å¼€å¼•è„šï¼Œè¾“å‡ºç”µä¿¡å·
                if temp&gt;=47:
                    gpio.output(port, 1)
                    is_close = False
                else:
            #æ¸©åº¦é™ä½åˆ°42æå…¶ä»¥ä¸‹æ—¶ï¼Œå…³é—­å¼•è„š
                    if temp&lt;=42:
                        gpio.output(port, 0)
                        is_close = True
                
        #ä¼‘çœ 3ç§’
            time.sleep(3)
            print &quot;temp:%s, fan is close:%s&quot; % (temp, is_close)
    except Exception, e:
        gpio.cleanup()        
 
if __name__ == '__main__':
    port = 8
    check_temp(port)

</code></pre>
<h3 id="33å¼€æœºè‡ªå¯è„šæœ¬">3.3å¼€æœºè‡ªå¯è„šæœ¬</h3>
<pre><code class="language-shell">[Unit]
Description=auto control fan by tmp

[Service]
Type=simple
User=nobody
WorkingDirectory=/home/pi/Gpio
ExecStart=/usr/bin/python -u /home/pi/Gpio/tmp.py
ExecStop=/bin/kill -s TERM &amp;MAINPID
User = root
[Install]
WantedBy=multi-user.target
</code></pre>
<h3 id="34å‚è€ƒè¿æ¥">3.4å‚è€ƒè¿æ¥</h3>
<p><a href="https://blog.csdn.net/oschina_41734362/article/details/80148833">https://blog.csdn.net/oschina_41734362/article/details/80148833</a></p>
<h2 id="4æ‘„åƒå¤´é…ç½®åŠä½¿ç”¨">4æ‘„åƒå¤´é…ç½®åŠä½¿ç”¨</h2>
<h3 id="41æ‘„åƒå¤´çš„å®‰è£…">4.1æ‘„åƒå¤´çš„å®‰è£…</h3>
<blockquote>
<p>åœ¨æ ‘è“æ´¾ä¸Šå®‰è£…å¥½æ‘„åƒå¤´å</p>
<p>sudo vim /etc/modules</p>
<p>åœ¨æœ€åä¸€è¡Œæ’å…¥</p>
<p>bcm2835-v4l2    (lä¸ºå°å†™å­—æ¯L)</p>
<p>åœ¨raspi-configä¸­å¼€å¯camera</p>
<p>æœ€årebootæ ‘è“æ´¾</p>
</blockquote>
<h3 id="42-motionç›‘æ§ç³»ç»Ÿ">4.2 Motionç›‘æ§ç³»ç»Ÿ</h3>
<blockquote>
<p>å®‰è£…</p>
<pre><code class="language-sh">sudo apt install motion
</code></pre>
<p>å¤‡ä»½é…ç½®æ–‡ä»¶</p>
<pre><code class="language-sh">sudo cp /etc/motion/motion.conf /etc/motion/motion.conf.bak
</code></pre>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<pre><code class="language-sh">vim /etc/motion/motion.conf

daemon on                        #å¼€å¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆé€‰é…ï¼‰
target_dir /home/pi/motion-images    #å›¾ç‰‡ä¿å­˜çš„è·¯å¾„
#videodevice /dev/video0            #æ‘„åƒå¤´è®¾å¤‡ï¼ˆé»˜è®¤ï¼‰å¯ä¿®æ”¹            
stream_localhost off                 #å…è®¸é€šè¿‡ç½‘é¡µæŸ¥çœ‹æ‘„åƒå¤´
stream_auth_method 2               #å¼€å¯å¯†ç è®¤è¯
stream_authentication ç”¨æˆ·å:å¯†ç     #ç½‘é¡µæŸ¥çœ‹æ‘„åƒå¤´çš„ç”¨æˆ·åå’Œå¯†ç 
</code></pre>
</blockquote>
<h2 id="5-ç›¸å…³è½¯ä»¶å®‰è£…">5 ç›¸å…³è½¯ä»¶å®‰è£…</h2>
<h3 id="51-oracel-jdk">5.1 oracel jdk</h3>
<pre><code class="language-sh">#1.åœ¨oracleå®˜ç½‘ä¸‹è½½æŒ‡å®šç‰ˆæœ¬çš„jdk
#https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html

#2.æ‹·è´åˆ°æ ‘è“æ´¾å¹¶è§£å‹
tar -zxvf jdk-8u261-linux-arm64-vfp-hflt.tar.gz

#3.åˆ›å»ºè½¯é“¾
sudo ln -s /home/pi/jdk1.8.0_261/bin/java /usr/bin/java
</code></pre>
<h3 id="52-rpigpio">5.2 RPi.GPIO</h3>
<pre><code class="language-sh">sudo apt-get install python3-rpi.gpio
</code></pre>
<h2 id="6-rtspç›´æ’­æ¨æµ">6 rtspç›´æ’­æ¨æµ</h2>
<p>å‚è€ƒé“¾æ¥ï¼ˆæœ¬è®°å½•ä¸­å¾ˆå¤šéœ€è¦ä¿®æ”¹ï¼‰ï¼š</p>
<p>https://blog.csdn.net/u013062192/article/details/80210166</p>
<ol>
<li>
<p>å®‰è£…live555</p>
<pre><code class="language-sh">è·å–live555æœ€æ–°æºç 
wget http://live555.com/liveMedia/public/live555-latest.tar.gz
è§£å‹ç¼–è¯‘å®‰è£…
tar -zxvf live555-latest.tar.gz
cd live
sudo ./genMakefiles linux
sudo make
sudo make install
</code></pre>
</li>
<li>
<p>å®‰è£…åº“æ–‡ä»¶</p>
<pre><code class="language-sh">sudo apt-get update
sudo apt-get install libavcodec54 
sudo apt-get install libswscale2
sudo apt-get install libx264-142
</code></pre>
</li>
<li>
<p>ç¼–è¯‘æ‰§è¡Œå·¥å…·</p>
<p><a href="http://git.oschina.net/secho1997/live_camera_linux">ä¸‹è½½æºç </a> copyåˆ°/opt/vc/src/hello_pi/</p>
<p>æ ¹æ®/hello_pi/ä¸‹çš„READMEç¼–è¯‘å®‰è£…iclientåº“</p>
<pre><code class="language-sh">sudo apt-get install libavcodec-dev
sudo apt-get install libswscale-dev 
sudo apt-get install libavutil-dev
</code></pre>
<p>å®‰è£…x264</p>
<pre><code class="language-sh">git clone git://git.videolan.org/x264.git
cd x264 
./configure --enable-shared --enable-pthread --enable-pic
make
make install
</code></pre>
<pre><code class="language-sh">cd live_camera_linux
sudo make
sudo make install
sudo ./zk_v4l2_x264_source

##æ­¤éƒ¨åˆ†ä¼šæŠ¥é”™ï¼Œéœ€è¦ä¿®æ”¹Makefileæ–‡ä»¶,å‚è€ƒä¸€ä¸‹å‚è€ƒé“¾æ¥é‡Œé¢çš„ä¿®æ”¹æ–¹æ³•
</code></pre>
<p>è‹¥å‡ºç°</p>
<pre><code class="language-sh">[2464] WebcamOndemandMediaSubsession .... calling
using url &quot;rtsp://192.168.1.102:9554/webcam&quot;
</code></pre>
<p>åˆ™æˆåŠŸ</p>
</li>
<li>
<p>æ’­æ”¾ç«¯ï¼š<br>
ä½¿ç”¨vlcç­‰å·¥å…·æ’­æ”¾rtspæµï¼š rtsp://IP_of_Raspi:9554/webcam</p>
</li>
</ol>

            </div>
            
              <div class="tag-container">
                
                  <a href="https://gaochrishao.github.io/tag/tag_linux/" class="tag">
                    Linux
                  </a>
                
              </div>
            
            

            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>


  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>
    hljs.initHighlightingOnLoad()
  </script>





  </body>
</html>
